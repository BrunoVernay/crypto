<!DOCTYPE html>

<html>

<head>
	<meta charset="UTF-8">
	<title>ARC4-Algorithm</title>
</head>

<body>
	<h1 style="text-align: center">Helptext of the ARC4/Spritz-Algorithm</h1>

	<p>Welcome to the helptext of the ARC4- and Spritz-Algorithm. This help describes the following aspects:</p>
	<ul>
		<li><a href="#func">Description of the algorithm</a></li>
		<li><a href="#sec">Security of RC4</a></li>
		<li><a href="#literature">Further references and literature</a></li>
	</ul>
	<p>Of course you do not have to read the first two chapters of this page to use the plug-in. If you aren't interested on the history of 
	RC4, its algorithm itself or the security aspects, feel free to directly jump to the <a href=UI/tutorialUI.html>user instructions</a>.</p>

	<h2 id="func">Description of the algorithm</h2>
	
	<p>
	RC4 and ARC4 respectively are cryptographic stream ciphers. RC4 became well known and widespread mainly because of its usage in standards 
	like HTTPS, SSH1 or WEP/WPA. RC4 has been developed by Ronald L. Rivest in the year 1987 as a trademark of RSA Security Inc., a
 	subcompany of EMC Corporation. Therefore, RC4 is not a freely accessible crypto-algorithm. Alleged RC4 (ARC4) is based on a anonymous 
	publication of source code (1994) and is now open-source and therefore it's freely usable.
	</p>
	<p>
	RC4 generates a (pseudo-) random bitstream which is then used as keystream to encrypt the plaintext through an exclusive disjunction
 	(XOR). The result of this operation is the cipher text. The basis of this generation in RC4 is a so called s-box. This s-box is a byte-
	vector with 256 elements which will first be assigned with values from 0 to 255. Afterwards these values will be permutated with the key. 
	After this initialisation the algorithm generates the random bitstream with well defined calculation rules. Every single step of the 
	generation concludes with the swapping of to values inside the s-box. The calculation for the RC4-algorithm uses very simple operations, 
	therefore it is easy to implement the algorithm in hard- and software. The execution of the algorithm itself is pretty fast in comparison
 	to other stream ciphers.
	</p>
	<p>The algorithm looks like the following. First of all the byte-vector (called s-box) will be filled with initial values:</p>

	<pre>
		k[] := key (length between 5 and 256 bytes)
		L   := length of the key (in bytes)
		s[] := byte-vector with 256 bytes

		For i = 0 to 255
			s[i] = i
		j = 0
		For i = 0 to 255
			j = (j + s[i] + k[i mod L]) mod 256
			swap s[i] and s[j]
	</pre>

	<p>
	The generation of the pseudo-random bitstream for the encryption looks like this:
	</p>

	<pre>
		plain[]  := plaintext of length X
		cipher[] := storage for the ciphertext
		i = 0
		j = 0

		For n = 0 to X-1
			i = (i + 1) mod 256
			j = (j + s[i]) mod 256
			swap s[i] and s[j]
			rand = s[ (s[i] + s[j]) mod 256 ]
			cipher[n] = rand XOR plain[n]
	</pre>

	<p>
	On 27th October, 2014, Ronald Rivest and Jacob Schuldt released an improved version of RC4 under the name "Spritz". Basically both, RC4 
	and Spritz, are using a very similar algorithm, but in Spritz a few calculations and rules have been changed a bit. This new algorithm is 
	only half as fast as RC4, which is itself a lot slowlier than AES (Advanced Encryption Standard).
	</p>

	<h2 id="sec">Security of (A)RC4</h2>

	<p>
	Basically, streamciphers can only be secure if the random bitstream generated by the algorithm is never the same as a bitstream generated 
	by the algorithm before, which means there is no way of predict the output of the generator with a better success chance than 1/2 (the 
	chance of success when just guessing). To achieve this, it is necessary to keep the key for algorithm secret and to use the key only 
	once. According to the birthday problem there may be two different keys which will lead to the same permutation of the s-box.
	</p>
	<p>
	Jacob Applebaum, a popular internet activist and a developer of the anonymisation network TOR, once said that the National Security 
	Agency (NSA) may be capable of cracking RC4 in realtime. According to the famous cryptologist and security expert Bruce Schneier 
	Applebaum's opinion is realistic.
	</p>
	<p>
	A few weaknesses of the RC4 algorithm (some of them being really heavy) are shown in <i>Weaknesses in the Key Scheduling Algorithm of 
	RC4</i> by Scott Fluhrer, Itsik Mantin and Adi Shamir. The weaknesses shown in this paper are mainly based on the derivation of the 
	initial state of RC4 with help of the key, but they will also have consequences for the generation of the bitstream. In the mentioned 
	paper, which is verbalised in a very mathematical way, the authors create an algorithm derived from RC4. Based on this altered RC4 they 
	show that certain patterns in the key are correlating with certain patterns in the internal state of RC4 and as a result the key or parts 
	of it may be calculated with the initial state, where the effort to to this is based on the length of the key. Afterwards the authors 
	prove that this weakness is present in the standard RC4 algorithm, too. On top of this, there is a strong correlation of the input key 
	and the output of the random-generator, when a key out of a relatively large class of weak keys is used. Because of this it is possible 
	to develop efficient algorithms capable of breaking RC4's security. Such an algorithm created by Shamir and Mantin is able to detect the 
	difference between the generator's output and real random numbers only with the second word of the output. As a result they recommend to 
	ignore the first and the second word and not to use them for encryption. Later they realised that one can calculate parts of the key 
	out of the output although dumping the first 2 words with an required effort of 2<sup>21</sup> (an effort of 2<sup>80</sup> or more is 
	required for secure techniques in cryptography). 
	</p>
	<p>
	Another severe weakness works like this: The key <i>K</i> for the algorithm basically consists of a secret part <i>sec</i> and a so 
	called initialisation-vector <i>IV</i> which is known to the public (and so it is to the attacker), and therefore <i>K = sec + IV</i>. 
	Under the precondition that the user uses the secret part of the key not only once, an attacker may be capable of calculate the secret 
	key with the help of the output and the (known) <i>IV</i> with relatively low effort (the effort depends on the length of the key and the 
	<i>IV</i>, of course). In reality it is often possible to guess the first words of the plaintext (for example if the first words are 
	timestamps or the identity of a client in some protocols), which makes a ciphertext-only-attack possible. In such an attack the attacker 
	can break the security of an encryption with the ciphertext only. Additionally Fluhrer, Mantin and Shamir show the possibility of 
	practically using these weaknesses to attack certain crypto-systems and techniques like the old, but wide-spread wireless security 
	standard WEP.</p>
	<p>
	In his paper <i>Attacks in the RC4 stream cipher</i> Andreas Klein describes another attack, which is mainly based on the attack already 
	shown by Fluhrer, Mantin and Shamir (which is also called <i>FMS-Attack</i>). In this method Klein observed the operations and states of 
	the algorithm in the stage of generating the key and the output of the algorithm. With this proceedure Klein was able to calculate a 
	previous state of the algorithm with high efficiency. To make things worse he also exposed the fact, that his new attack works with 
	the first 256 bytes discarded, too. This is why he recommends users to dump the outputs of at least the first 12 rounds of the algorithm 
	in order to make an attack impossible or at least very hard. In March, 2013, AlFardan, Bernstein, Paterson, Poettering and Schuldt 
	described one of the latest attack scenarios on RC4. In this scenario an attacker can read a few messages encrypted with RC4 and then 
	sent over TLS-connections. At this it is necessary that the same plaintext is encrypted and sent over more than just one connection. The 
	authors are using statistical biases in the key generation of RC4 which are making an differentiation between the output and really 
	random bits possible and therefore making an attacker able to break the security of RC4. They recommend not to use RC4 anymore 
	and to use secure cipher suites instead (like the fast and secure AES in CBC-mode).
	</p>
	<p>
	To sum things up, organisations and authorities like the <i>European Network and Information Security Agency (ENISA)</i> or the german 
	<i>Federal Office for Information Security</i> (in german: <i>Bundesamt für Sicherheit in der Informationstechnik (BSI)</i>) recommend 
	not to use RC4 any longer. Instead one should use secure standards like the streamciphers <i>Rabbit</i> or <i>Snow 3G</i> or the 
	blockcipher <i>Advanced Encryption Standard (AES)</i>, which is probably the most popular encryption standard today.
	</p>

	<h2 id="literature">Further references and literature</h2>

	<p>Further information on cryptography and (A)RC4 are available here:</p>
	<ul>
		<li><a href="https://en.wikipedia.org/wiki/RC4">(A)RC4 on the english wikipedia</a></li>
		<li><a href="http://www.cryptool.org/images/ctp/documents/CrypToolScript-en.pdf">CrypTool script in english</a></li>
		<li><a href="http://www.wisdom.weizmann.ac.il/~itsik/RC4/Papers/Rc4_ksa.ps"><i>Weaknesses in the Key Scheduling Algorithm of RC4
			</i>, Fluhrer, Mantin, Shamir</a></li>
		<li><a href="http://www.isg.rhul.ac.uk/tls/"><i>On the Security of RC4 in TLS and WPA</i>, AlFardan, Bernstein, Paterson, 
			Poettering, Schuldt</a></li>
	</ul>
</body>
</html>
